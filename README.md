# ğŸ“º Tube Sorter (ìœ íŠœë¸Œ ì˜ìƒ ìë™ ë¶„ë¥˜ê¸°)

`tube-sorter`ëŠ” íŠ¹ì • ìœ íŠœë¸Œ ì±„ë„ì— ì—…ë¡œë“œëœ ì˜ìƒì„ ê°ì§€í•˜ì—¬, ë¯¸ë¦¬ ì •ì˜ëœ í‚¤ì›Œë“œ ê·œì¹™ì— ë”°ë¼ ì‚¬ìš©ìì˜ ì¬ìƒëª©ë¡(Playlist)ìœ¼ë¡œ ìë™ ë¶„ë¥˜ ë° ë°°ì •í•´ì£¼ëŠ” ìë™í™” ë„êµ¬ì…ë‹ˆë‹¤.

## ğŸš€ ì£¼ìš” ê¸°ëŠ¥

- **ì§€ëŠ¥ì  ë§¤ì¹­**: ì˜ìƒ ì œëª©ì˜ ê³µë°±ê³¼ ëŒ€ì†Œë¬¸ìë¥¼ ë¬´ì‹œí•˜ëŠ” ì •ê·œí™”($\text{Normalization}$) ë° ê¸´ í‚¤ì›Œë“œ ìš°ì„  ë§¤ì¹­ ì•Œê³ ë¦¬ì¦˜ ì ìš©.
- **ë©±ë“±ì„±($\text{Idempotency}$) ë³´ì¥**: ì¬ìƒëª©ë¡ ì¶”ê°€ ì „ ì¤‘ë³µ ì—¬ë¶€ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•˜ì—¬ ë™ì¼ ì˜ìƒì˜ ì¤‘ë³µ ë“±ë¡ì„ ì›ì²œ ì°¨ë‹¨.
- **í• ë‹¹ëŸ‰ ìµœì í™”**: ìœ íŠœë¸Œ API í• ë‹¹ëŸ‰($\text{Quota}$)ì„ ê³ ë ¤í•˜ì—¬ ì‹¤ì œ ì¶”ê°€ ì‘ì—… íšŸìˆ˜ ê¸°ì¤€ìœ¼ë¡œ ì²˜ë¦¬ëŸ‰ì„ ì œí•œí•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ í†µì‹ .
- **ì™„ì „ ìë™í™”**: GitHub Actionsë¥¼ í†µí•´ ë§¤ì¼ ì •ê¸° ì‹¤í–‰ ë° ìˆ˜ë™ íŠ¸ë¦¬ê±° ì§€ì›.
- **ìƒíƒœ ì˜ì†ì„±**: ì „ìš© ë°ì´í„° ë¸Œëœì¹˜(`state-tracking`)ë¥¼ í™œìš©í•˜ì—¬ ì½”ë“œ íˆìŠ¤í† ë¦¬ì™€ ë¶„ë¦¬ëœ ì•ˆì •ì ì¸ ì‘ì—… ì‹œì  ê´€ë¦¬.

---

## ğŸ›  ë¡œì»¬ ì„¤ì¹˜ ë° ì„¤ì •

### 1. ìš”êµ¬ ì‚¬í•­
- Python 3.13 ì´ìƒ
- Google Cloud Consoleì—ì„œ ë°œê¸‰ë°›ì€ OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ìê²© ì¦ëª… (`client_secrets.json`)

### 2. í™˜ê²½ êµ¬ì¶•
```bash
# ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
python -m venv venv
source venv/bin/activate  # macOS/Linux

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt
```

### 3. ì„¤ì • íŒŒì¼ ì¤€ë¹„
1. **`.env`**: í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (`.env.example` ì°¸ê³ )
   - `TARGET_CHANNEL_ID`: ëª¨ë‹ˆí„°ë§í•  ìœ íŠœë¸Œ ì±„ë„ ID
   - `MAX_PROCESS_COUNT`: í•œ ë²ˆì— ì²˜ë¦¬í•  ì˜ìƒ ê°œìˆ˜
2. **`rules.json`**: ë¶„ë¥˜ ê·œì¹™ ì„¤ì •
   - `keyword`: ë§¤ì¹­í•  ë‹¨ì–´
   - `description`: ê·œì¹™ ì„¤ëª…

### 4. ìµœì´ˆ ì¸ì¦
ìµœì´ˆ 1íšŒ ë¡œì»¬ì—ì„œ ì¸ì¦ì„ ìˆ˜í–‰í•˜ì—¬ `token.json`ì„ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.
```bash
python authorize.py
```

---

## ğŸ¤– GitHub Actions ìë™í™” ìš´ì˜

ì´ í”„ë¡œì íŠ¸ëŠ” GitHub Actionsë¥¼ í†µí•´ í´ë¼ìš°ë“œì—ì„œ ìë™ìœ¼ë¡œ ë™ì‘í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

### 1. GitHub Secrets & Variables ì„¤ì •
ì €ì¥ì†Œì˜ `Settings > Secrets and variables > Actions` ë©”ë‰´ì—ì„œ ë‹¤ìŒ í•­ëª©ì„ ì„¤ì •í•©ë‹ˆë‹¤.

| êµ¬ë¶„ | ì´ë¦„ | ë‚´ìš© |
| :--- | :--- | :--- |
| **Secrets** | `CLIENT_SECRETS_JSON` | `client_secrets.json` íŒŒì¼ ë‚´ìš© ì „ì²´ |
| **Secrets** | `TOKEN_JSON` | `token.json` íŒŒì¼ ë‚´ìš© ì „ì²´ |
| **Secrets** | `ENV_FILE` | `.env` íŒŒì¼ ë‚´ìš© ì „ì²´ |
| **Variables** | `MAX_PROCESS_COUNT` | (ì„ íƒ) UIì—ì„œ ë°”ë¡œ ìˆ˜ì •í•  ì²˜ë¦¬ ê°œìˆ˜ |

### 2. ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ë°©ë²•
- **ì •ê¸° ì‹¤í–‰**: ë§¤ì¼ í•œêµ­ ì‹œê°„(KST) ìƒˆë²½ 3ì‹œì— ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.
- **ìˆ˜ë™ ì‹¤í–‰**: `Actions > Tube Sorter Manual Run`ì—ì„œ ì‹¤í–‰ ê°€ëŠ¥í•˜ë©°, ë‹¤ìŒ ì˜µì…˜ì„ ì œê³µí•©ë‹ˆë‹¤.
  - `max_process_count`: ì¼ì‹œì ìœ¼ë¡œ ì²˜ë¦¬ëŸ‰ì„ ëŠ˜ë¦¬ê³  ì‹¶ì„ ë•Œ ì…ë ¥
  - `reset_state`: `true` ì…ë ¥ ì‹œ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë¶„ë¥˜ ì‹œì‘

### 3. ìƒíƒœ ê´€ë¦¬ (State Persistence)
ìë™í™” ì‹¤í–‰ í›„ì˜ ë§ˆì§€ë§‰ ì‘ì—… ì‹œì ì€ **`state-tracking`** ë¸Œëœì¹˜ì˜ `state.json`ì— ì €ì¥ë©ë‹ˆë‹¤. ì´ëŠ” ë©”ì¸ ì½”ë“œ íˆìŠ¤í† ë¦¬ë¥¼ ê¹¨ë—í•˜ê²Œ ìœ ì§€í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.

---

## ğŸ— ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

- `models.py`: ë„ë©”ì¸ ë°ì´í„° êµ¬ì¡° ì •ì˜
- `youtube_service.py`: ìœ íŠœë¸Œ API í†µì‹  ë° ë©±ë“±ì„± ë¡œì§ ì „ë‹´
- `rule_engine.py`: ë¶„ë¥˜ ë° ë§¤ì¹­ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- `storage.py`: íŒŒì¼ ì…ì¶œë ¥ ë° ìœ íš¨ì„± ê²€ì‚¬
- `sorter.py`: ì „ì²´ ì›Œí¬í”Œë¡œìš° ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```bash
PYTHONPATH=. pytest
```

**ì°¸ê³  ë¬¸í—Œ:**
- [YouTube Data API v3 Documentation](https://developers.google.com/youtube/v3/docs)
- [GitHub Actions Documentation](https://docs.github.com/en/actions)